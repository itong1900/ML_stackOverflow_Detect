    library(tm)
    library(MASS)
    library(rpart)
    library(boot)
    library(SnowballC)
    library(wordcloud)
    library(caTools)
    library(dplyr)
    library(rpart.plot)
    library(randomForest)
    library(caret)

    ## load the data, and a quick view of data, the data is consisted of Title, Body, score, we'll mainly dig in to Title and Body and infer score
    data = read.csv("ggplot2questions2016_17.csv", sep = ",", stringsAsFactors = FALSE)
    clean_data = data
    head(data,5)

    ##                                                           Title
    ## 1                                     Missing Ribbon in ggplot2
    ## 2                     ggplot - label as calculated increase (%)
    ## 3                       Add legend to a ggplot2 from empty plot
    ## 4 Using ggplot to plot occupied parking spaces in a parking lot
    ## 5                           object not found but exists ggplot2
    ##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Body
    ## 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         <p>I seem to be having trouble setting up a ribbon in ggplot2 to display. </p>\n\n<p>Here's a made up data set:</p>\n\n<pre><code>&gt; GlobalDFData\n  Estimate Upper  Lower  Date   Area\n1      100   125    75 Q1_16 Global\n2      125   150   100 Q2_16 Global\n3      150   175   125 Q3_16 Global\n4      175   200   150 Q4_16 Global\n</code></pre>\n\n<p>Here's the code that I'm trying with no success. I get the line chart but not the upper and lower bounds</p>\n\n<pre><code>ggplot(GlobalDFData, aes(x = Date)) + \n  geom_line(aes(y = Estimate, group = Area, color = Area))+\n  geom_point(aes(y = Estimate, x = Date))+\n  geom_ribbon(aes(ymin = Lower, ymax = Upper))\n</code></pre>\n
    ## 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         <p>I have developed a ggplot graph but now I am trying to add calculated label which shows increase in % year-on-year?</p>\n\n<p>My data frame is very simple (result of aggregate from the main dataset)</p>\n\n<pre><code>'data.frame':   4 obs. of  3 variables:\n $ Year    : int  2011 2012 2013 2014\n $ TotalPay: num  71744 74113 77611 75466\n</code></pre>\n\n<p>I have a code for my graph:</p>\n\n<pre><code>library(ggplot2)\nggplot(d1, aes(x=Year, y=TotalPay)) + geom_bar(stat="identity") + \nlabs(x="Year", y="Average Total Pay ($)")\n</code></pre>\n\n<p>and now trying to use stat_bin for lables? The calculation is Actual Year - Previous Year * 100%. I have this but not sure how to fill percent ()</p>\n\n<pre><code>stat_bin(aes (labels = paste("Total Pay" = ,scales::percent(())), vjust = 1, geom = "TexT")\n</code></pre>\n
    ## 3 <p>I am creating a circular plot of correlations and I want to draw two type of information:</p>\n\n<ol>\n<li>A circle from -1 to 1 in both axis</li>\n<li>Add those correlations where the first component and the second component are different from 0 as arrows</li>\n<li>Add as dots those correlations having the first or the second component equal to 0 </li>\n</ol>\n\n<p>The colour used to draw each arrow/dot is integrated in the data.all <code>all</code>:</p>\n\n<ul>\n<li>1st column: X axis</li>\n<li>2nd column: Y axis</li>\n<li>3th column: <em>feature</em> (colour)</li>\n</ul>\n\n<p>(<strong>UPDATED</strong>) What I code is:</p>\n\n<pre><code>## Colors for datasets\nfColor &lt;- c("yellow", "blue", "green", "red")\nnames(fColor) &lt;- c("background", "isolation_p", "media", "solution")\n## /\n\n## Filters for 0s\nf1 &lt;- all[ , 1] != 0 &amp; all[ , 2] != 0\nf2 &lt;- all[ , 1] == 0 | all[ , 2] == 0\n## /\n\n## Draw Circle\ntheta &lt;- c(seq(-pi, pi, length = 50), seq(pi, -pi, length = 50))\ncircle &lt;- data.frame(xcircle = cos(theta), ycircle = sin(theta))\np &lt;- ggplot2::ggplot(data = circle, ggplot2::aes_string("xcircle", "ycircle")) +\n  ggplot2::geom_path(ggplot2::aes_string("xcircle", "ycircle")) +\n  ggplot2::geom_hline(yintercept = 0, linetype = "dashed") +\n  ggplot2::geom_vline(xintercept = 0, linetype = "dashed")\n## /\n\n## Draw arrows\np &lt;- p + ggplot2::geom_segment(data = all[f1, ],\n   ggplot2::aes_string(x = 0, y = 0, xend = "x", yend = "y"),\n   arrow = grid::arrow(length = grid::unit(0.2, "cm")),\n   color = fColor[all$feature[f1]], linetype = "solid")\n## /\n\n## Draw points\np &lt;- p + ggplot2::geom_point(data = all[f2, ],\n   ggplot2::aes_string("x", "y"),\n   color = fColor[all$feature[f2]], shape = 19, size = 2)\n## /\n\n## Add axis labels\np &lt;- p + ggplot2::scale_y_continuous("First Component") +\n  ggplot2::scale_x_continuous("Second Component")\n## /\n</code></pre>\n\n<p>Now I want to add a legend for the colours used in the plots, but I am not capable of adding it. ¿Some ideas?</p>\n\n<p>(<strong>UPDATE</strong>) What I would like to see into the legend is a red-bullet for solution, a green-bullet for media, a yellow-bullet for background and a blue-bullet for background (with the labels from <em>feature</em>, 3th column of <code>all</code>).</p>\n\n<h1>+info</h1>\n\n<p>(<strong>UPDATE</strong>) Fragment of my <code>all</code> data.frame:</p>\n\n<pre><code>all &lt;- read.table(text = "x y   feature\nyc01002711  -0.1755657  0.0000000000    background\nyc02001111  0.0000000   -0.0006935916   background\nyc03001287  0.0000000   -0.3966829792   background\nyc04001667  0.0000000   -0.0575593341   background\nxx00000091  -0.4205095  0.0000000000    isolation_p\nxx00000092  0.0000000   -0.0085758016   isolation_p\nsc78    0.03099176  -0.1425365  media\nsc88    0.03897109  0.0000000   media\nsc09    -0.05278946 0.0000000   media\ninm10058    -0.05277376 0.0000000   solution\ninm10099    -0.05286904 0.0000000   solution\ninm10101    -0.08174610 -0.1315094  solution")\n</code></pre>\n\n<p>Example for the drawn plot:</p>\n\n<p><a href="https://i.stack.imgur.com/PfS58.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/PfS58.png" alt="Plot of the two components"></a></p>\n
    ## 4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           <p>I’d like to use ggplot to draw a grid plot of the following scenario which I’ve attempted to depict in the picture below... I could use some guidance on how to logically think about the approach.  Thank you for the guidance.</p>\n\n<h2>--</h2>\n\n<p>Each aisle in the example picture below has an odd number side—and an even number side\n<BR>\nThe spaces on the odd-side are listed ascending from 1… K where K is odd\n<BR>\nThe spaces on the even-side are listed ascending from 2…N where N is even \n<BR>\nThis pattern exists for each aisle in the parking lot</p>\n\n<p>If a car is parked in a space—we track that spot in a database.</p>\n\n<p>How can I reproduce a grid-level ggplot to indicate with a symbol on the plot all spaces where a car is parked?</p>\n\n<p><a href="https://i.stack.imgur.com/A3PRb.jpg" rel="noreferrer"><img src="https://i.stack.imgur.com/A3PRb.jpg" alt="Parking Lot Example"></a>\n<BR></p>\n\n<p>The listing of occupied spaces would be “fed” into the ggplot logic via a .csv file:  the format of the .csv would look something like this:</p>\n\n<p>A01\n<BR>\nA04\n<BR>\nA05\n<BR>\nA08\n<BR>\nA09\n<BR>\nA15\n<BR>\nA20\n<BR>\nA33\n<BR>\nB07\n<BR>\nB31\n<BR>\nB44\n<BR>\nC01\n<BR>\nC04\n<BR>\nC36\n<BR>\n...\n<BR></p>\n\n<p>Image credit: Michael Layefsky, 2010, Google Images</p>\n
    ## 5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <p>I am trying to make a bar graph with error bars, and I would like to also add letter labels to indicate statistical significant between each group over the bars. However, when I add the code for the labeling, I get the following message:</p>\n\n<pre><code>Error in eval(expr, envir, enclos) : object 'treatment.area' not found\n</code></pre>\n\n<p>Here is the code I am using to produce the graph:</p>\n\n<pre><code># This data frame calculates statistics for each treatment.\ndata.summary.area &lt;- data.frame(treatment.area = levels(shapes.a$Exposure),\n  mean.a=tapply(shapes$Area, shapes$Exposure, mean),\n  n.a=tapply(shapes$Area, shapes$Exposure, length),\n  sd.a=tapply(shapes$Area, shapes$Exposure, sd))\n\n# Precalculate standard error of the mean (SEM)\ndata.summary.area$sem.a &lt;- data.summary.area$sd.a/sqrt(data.summary.area$n.a)\n\n# Precalculate margin of error for confidence interval\ndata.summary.area$me &lt;- qt(1-alpha/2, df=data.summary.area$n.a)*data.summary.area$sem\n#Get some stats\n label.area.cor &lt;- data.frame(Group=c("CON CCCP", "CON DMSO", "HF CCCP", "HF DMSO"),\nValue = c(0.15, 0.18, 0.16, 0.25))\n# Make the plot\nrequire(ggplot2)\n\npng('barplot-sem-mito.area.lab.stat.png')\nggplot(data.summary.area, aes(x = treatment.area, y = mean.a)) +  \ngeom_bar(position = position_dodge(), stat="identity", \n        fill=c('red', 'red4', 'forestgreen', 'darkgreen')) + \ngeom_errorbar(aes(ymin=mean.a-sem.a, ymax=mean.a+sem.a)) +\nggtitle("Mitochondria Area after 24h CCCP exposure, GV oocytes") +   xlab("Exposure")+ \n   ylab(expression(paste("Area, u"^"2"))) +\n   theme_bw()+  geom_text(data = label.area.cor, \n                      aes(label=c("a", "b", "c", "d")))+\n   theme(panel.grid.major = element_blank())\ndev.off()\n</code></pre>\n
    ##   Score
    ## 1     3
    ## 2     3
    ## 3     3
    ## 4     6
    ## 5     1

========= \#\# Data Cleaning ========== Let’s start with Data Cleaning

1.  remove
    <html>
    tag, as it’s not meaningful in prediction and add unecessary noise
    <br/>
2.  remove $\\n \\t$ <br/>
3.  all text convert to lower case <br/>
4.  remove puntunctuation <br/>
5.  remove stopwords(more details will be given at that step) <br/>
6.  stem the documents <br/>

<!-- -->

    ## doing i, ii
    clean_data$Body = gsub("<.*?>", "",clean_data$Body)
    clean_data$Body = gsub("[\n\t]", "", clean_data$Body)

    ## before going to next steps, convert all body to corpus for easier analysis
    corpusBody = Corpus(VectorSource(clean_data$Body))#create corpus

    ## step iii to lower
    corpusBody = tm_map(corpusBody, tolower)#to lower case
    ## step iv remove punctuation
    corpusBody = tm_map(corpusBody, removePunctuation)#remove punctuation

From Wikipedia, Stop words are defined as "“In computing, stop words are
words which are filtered out before or after processing of natural
language data.” In our case, we’ll remove top 10 stop words in English,
as well as “ggplot” and “ggplot2” since they are over common in this
topic

    ## step v 
    stopwords("english")[1:10] # find top stopwords

    ##  [1] "i"         "me"        "my"        "myself"    "we"        "our"      
    ##  [7] "ours"      "ourselves" "you"       "your"

    length(stopwords("english"))

    ## [1] 174

    corpusBody = tm_map(corpusBody, removeWords, c("ggplot2","ggplot", stopwords("english")))

Also from Wikipedia, word steming is defined as “In linguistics, a stem
is a part of a word used with slightly different meanings and would
depend on the morphology of the language in question. In Athabaskan
linguistics, for example, a verb stem is a root that cannot appear on
its own, and that carries the tone of the word”. We’ll apply the steming
to the corpusBody as our last data cleaning process.

    ## step vi stem the documents
    corpusBody = tm_map(corpusBody, stemDocument)

    ## Finally, as an example, let's look at the how the body of our first row are finally converted 
    strwrap(corpusBody[[1]])

    ## [1] "seem troubl set ribbon display here made data setgt globaldfdata estim" 
    ## [2] "upper lower date area1 100 125 75 q116 global2 125 150 100 q216 global3"
    ## [3] "150 175 125 q316 global4 175 200 150 q416 globalher code im tri success"
    ## [4] "get line chart upper lower boundsggplotglobaldfdata aesx date"          
    ## [5] "geomlineaesi estim group area color area geompointaesi estim x date"    
    ## [6] "geomribbonaesymin lower ymax upper"
